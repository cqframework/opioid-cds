{
  "resourceType": "Library",
  "id": "library-OpioidCDSREC04PatientView",
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/cdc/opioid-cds/Library/OpioidCDSREC04PatientView",
  "version": "2.0.1",
  "name": "OpioidCDSREC04PatientView",
  "relatedArtifact": [ {
    "type": "depends-on",
    "display": "FHIR model information"
  }, {
    "type": "depends-on",
    "display": "Library FHIRHelpers"
  }, {
    "type": "depends-on",
    "display": "Library Common"
  }, {
    "type": "depends-on",
    "display": "Library Config"
  }, {
    "type": "depends-on",
    "display": "Library Routines"
  }, {
    "type": "depends-on",
    "display": "Value set Community"
  }, {
    "type": "depends-on",
    "display": "Value set Active MedicationRequest"
  }, {
    "type": "depends-on",
    "display": "Value set Opioid analgesics with ambulatory misuse potential"
  }, {
    "type": "depends-on",
    "display": "Value set Extended release opioid with ambulatory misuse potential"
  }, {
    "type": "depends-on",
    "display": "Value set Encounter Diagnosis Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Problem List Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set US Core Health Concern Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Limited life expectancy conditions"
  }, {
    "type": "depends-on",
    "display": "Value set Active Condition"
  }, {
    "type": "depends-on",
    "display": "Value set Therapies indicating end of life care"
  }, {
    "type": "depends-on",
    "display": "Value set Conditions likely terminal for opioid prescribing"
  }, {
    "type": "depends-on",
    "display": "Value set Hospice Procedure Codes"
  } ],
  "parameter": [ {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Patient"
  }, {
    "name": "Chronic Pain Extended Release Opioid Analgesic with Ambulatory Misuse Potential Prescriptions",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "MedicationRequest"
  }, {
    "name": "Patient Is Being Prescribed Extended Release Opioid Analgesic with Ambulatory Misuse Potential",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Age Less Than 18",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Inclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Exclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Is Recommendation Applicable?",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Get Indicator",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Get Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Get Detail",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  } ],
  "dataRequirement": [ {
    "type": "Patient",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/MedicationRequest" ],
    "mustSupport": [ "status" ],
    "codeFilter": [ {
      "path": "status"
    } ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/MedicationRequest" ],
    "mustSupport": [ "recorder", "dosageInstruction", "authoredOn", "dispenseRequest", "subject", "medication.reference", "medication", "id", "category", "intent", "status" ],
    "codeFilter": [ {
      "path": "status"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "mustSupport": [ "code", "status.value", "status" ],
    "codeFilter": [ {
      "path": "code"
    } ]
  }, {
    "type": "ServiceRequest",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/ServiceRequest" ],
    "mustSupport": [ "code", "status.value", "status" ],
    "codeFilter": [ {
      "path": "code"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Encounter" ],
    "mustSupport": [ "period.start", "period", "status.value", "status" ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBPcGlvaWRDRFNSRUMwNFBhdGllbnRWaWV3IHZlcnNpb24gJzEuMi4zJwoKdXNpbmcgRkhJUiB2ZXJzaW9uICczLjAuMCcKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnMy4wLjAnIGNhbGxlZCBGSElSSGVscGVycwppbmNsdWRlIE9waW9pZENEU0NvbW1vbiB2ZXJzaW9uICcxLjIuMycgY2FsbGVkIENvbW1vbgppbmNsdWRlIE9waW9pZENEU1JvdXRpbmVzIHZlcnNpb24gJzEuMi4zJyBjYWxsZWQgUm91dGluZXMKaW5jbHVkZSBPcGlvaWRDRFNDb21tb25Db25maWcgdmVyc2lvbiAnMS4yLjMnIGNhbGxlZCBDb25maWcKCi8qCioqCioqICBSZWNvbW1lbmRhdGlvbiAjNAoqKiAgICBQcmVzY3JpYmUgaW1tZWRpYXRlLXJlbGVhc2Ugb3Bpb2lkcyBpbnN0ZWFkIG9mIGV4dGVuZGVkLXJlbGVhc2UvbG9uZy1hY3RpbmcgKEVSL0xBKSBvcGlvaWRzCioqCioqICBXaGVuCioqICAgIFByb3ZpZGVyIGlzIHByZXNjcmliaW5nIGFuIGV4dGVuZGVkIHJlbGVhc2Ugb3Bpb2lkIHdpdGggYW1idWxhdG9yeSBtaXN1c2UgcG90ZW50aWFsIGluIHRoZSBvdXRwYXRpZW50IHNldHRpbmcKKiogICAgUHJlc2NyaXB0aW9uIGlzIGZvciB0cmVhdGluZyBjaHJvbmljIHBhaW4uCioqICAgIE9waW9pZCByZXZpZXcgaXMgdXNlZnVsIGZvciB0aGlzIHBhdGllbnQ6CioqICAgICAgUGF0aWVudCBpcyAxOCBvciBvdmVyCioqICAgICAgUGF0aWVudCBkb2VzIG5vdCBoYXZlIGZpbmRpbmdzIGluZGljYXRpbmcgbGltaXRlZCBsaWZlIGV4cGVjdGFuY3kKKiogICAgICBQYXRpZW50IGRvZXMgbm90IGhhdmUgb3JkZXJzIGZvciB0aGVyYXBpZXMgaW5kaWNhdGluZyBlbmQgb2YgbGlmZSBjYXJlCioqICAgICAgUGF0aWVudCBpcyBub3QgdW5kZXJnb2luZyBhY3RpdmUgY2FuY2VyIHRyZWF0bWVudDoKKiogICAgICAgIFBhdGllbnQgaGFzIGhhZCBhdCBsZWFzdCAyIGVuY291bnRlcnMgd2l0aGluIHRoZSBwYXN0IHllYXIgd2l0aCBhbnkgZGlhZ25vc2lzIG9mIGNhbmNlcgoqKiAgICBQYXRpZW50IGlzIG9waW9pZCBuYWl2ZToKKiogICAgICBObyBpbmRpY2F0aW9uIG9mIG9waW9pZCB1c2UgaW4gdGhlIHBhc3QgOTAgZGF5cyBmcm9tIGEgcHJlc2NyaXB0aW9uLCBzZWxmIHJlcG9ydCwgb3IgYSBkaXNwZW5zaW5nIGV2ZW50CioqICBUaGVuCioqICAgIFJlY29tbWVuZCB1c2Ugb2YgaW1tZWRpYXRlIHJlbGVhc2Ugb3Bpb2lkczoKKiogICAgICBXaWxsIHByZXNjcmliZSBpbW1lZGlhdGUgcmVsZWFzZSBvcGlvaWQgYW5hbGdlc2ljIHdpdGggYW1idWxhdG9yeSBtaXN1c2UgcG90ZW50aWFsCioqICAgICAgQmVuZWZpdHMgb3V0d2VpZ2ggcmlza3MsIHNub296ZSAzIG1vbnRocwoqKiAgICAgIE4vQSAtIHNlZSBjb21tZW50LCBzbm9vemUgMyBtb250aHMKKioKKi8KCi8vIE1FVEE6IFBsYW4gRGVmaW5pdGlvbjogaHR0cDovL2ZoaXIub3JnL2d1aWRlcy9jZGMvb3Bpb2lkLWNkcy1yNC9QbGFuRGVmaW5pdGlvbi9vcGlvaWQtY2RzLTA0Cgpjb250ZXh0IFBhdGllbnQKCmRlZmluZSAiQ2hyb25pYyBQYWluIEV4dGVuZGVkIFJlbGVhc2UgT3Bpb2lkIEFuYWxnZXNpYyB3aXRoIEFtYnVsYXRvcnkgTWlzdXNlIFBvdGVudGlhbCBQcmVzY3JpcHRpb25zIjoKICBDb21tb24uIkFjdGl2ZSBBbWJ1bGF0b3J5IE9waW9pZCBSeCIgQW1idWxhdG9yeU9waW9pZFByZXNjcmlwdGlvbgogICAgd2hlcmUgUm91dGluZXMuIklzIENocm9uaWMgUGFpbiBQcmVzY3JpcHRpb24/IihBbWJ1bGF0b3J5T3Bpb2lkUHJlc2NyaXB0aW9uKQogICAgICBhbmQgQW1idWxhdG9yeU9waW9pZFByZXNjcmlwdGlvbi5tZWRpY2F0aW9uIGluIENvbW1vbi4iRXh0ZW5kZWQgcmVsZWFzZSBvcGlvaWQgYW5hbGdlc2ljcyB3aXRoIGFtYnVsYXRvcnkgbWlzdXNlIHBvdGVudGlhbCIKCmRlZmluZSAiUGF0aWVudCBJcyBCZWluZyBQcmVzY3JpYmVkIEV4dGVuZGVkIFJlbGVhc2UgT3Bpb2lkIEFuYWxnZXNpYyB3aXRoIEFtYnVsYXRvcnkgTWlzdXNlIFBvdGVudGlhbCI6CiAgZXhpc3RzICgiQ2hyb25pYyBQYWluIEV4dGVuZGVkIFJlbGVhc2UgT3Bpb2lkIEFuYWxnZXNpYyB3aXRoIEFtYnVsYXRvcnkgTWlzdXNlIFBvdGVudGlhbCBQcmVzY3JpcHRpb25zIikKCmRlZmluZSAiSXMgUmVjb21tZW5kYXRpb24gQXBwbGljYWJsZT8iOgogICJJbmNsdXNpb24gQ3JpdGVyaWEiCiAgICBhbmQgbm90ICJFeGNsdXNpb24gQ3JpdGVyaWEiCgpkZWZpbmUgIlBhdGllbnQgQWdlIExlc3MgVGhhbiAxOCI6CiAgaWYgKENvbmZpZy4iQWdlIExlc3MgdGhhbiAxOCBZZWFycyBJcyBFbmFibGVkIikgdGhlbgogICAgQWdlSW5ZZWFyc0F0KFRvZGF5KCkpIDwgMTgKICBlbHNlCiAgICBmYWxzZQoKZGVmaW5lICJJbmNsdXNpb24gQ3JpdGVyaWEiOgogICJQYXRpZW50IElzIEJlaW5nIFByZXNjcmliZWQgRXh0ZW5kZWQgUmVsZWFzZSBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIgogICAgYW5kIG5vdCAiUGF0aWVudCBBZ2UgTGVzcyBUaGFuIDE4IgogICAgYW5kIFJvdXRpbmVzLiJJcyBPcGlvaWQgUmV2aWV3IFVzZWZ1bD8iCiAgICBhbmQgUm91dGluZXMuIklzIE9waW9pZCBOYWl2ZT8iCgpkZWZpbmUgIkV4Y2x1c2lvbiBDcml0ZXJpYSI6CiAgQ29tbW9uLiJFbmQgb2YgTGlmZSBBc3Nlc3NtZW50IgoKZGVmaW5lICJHZXQgSW5kaWNhdG9yIjoKICBpZiAiSXMgUmVjb21tZW5kYXRpb24gQXBwbGljYWJsZT8iCiAgICB0aGVuICd3YXJuaW5nJwogIGVsc2UgbnVsbAoKZGVmaW5lICJHZXQgU3VtbWFyeSI6CiAgaWYgIklzIFJlY29tbWVuZGF0aW9uIEFwcGxpY2FibGU/IgogICAgdGhlbiAnUmVjb21tZW5kIHVzZSBvZiBpbW1lZGlhdGUtcmVsZWFzZSBvcGlvaWRzIGluc3RlYWQgb2YgZXh0ZW5kZWQgcmVsZWFzZS9sb25nIGFjdGluZyBvcGlvaWRzIHdoZW4gc3RhcnRpbmcgcGF0aWVudCBvbiBvcGlvaWRzLicKICBlbHNlIG51bGwKCmRlZmluZSAiR2V0IERldGFpbCI6CiAgaWYgIklzIFJlY29tbWVuZGF0aW9uIEFwcGxpY2FibGU/IgogICAgdGhlbiAnVGhlIGZvbGxvd2luZyBtZWRpY2F0aW9uIHJlcXVlc3RzKHMpIHJlbGVhc2UgcmF0ZXMgc2hvdWxkIGJlIHJlLWV2YWx1YXRlZDogJwogICAgICArIENvbWJpbmUoKCJDaHJvbmljIFBhaW4gRXh0ZW5kZWQgUmVsZWFzZSBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIFByZXNjcmlwdGlvbnMiIE0KICAgICAgICAgIHJldHVybiBDb2FsZXNjZShNLm1lZGljYXRpb24udGV4dCwgJzxVbmFibGUgdG8gZGV0ZXJtaW5lIG1lZGljYXRpb24gbmFtZT4nKSksICcsICcpCiAgZWxzZSBudWxsCgogIC8vIERldGVjdGVkIElzc3VlIC0gUHJlc2NyaWJlIGltbWVkaWF0ZS1yZWxlYXNlIG9waW9pZHMgaW5zdGVhZCBvZiBleHRlbmRlZC1yZWxlYXNlL2xvbmctYWN0aW5nIChFUi9MQSkgb3Bpb2lkcwoKICBkZWZpbmUgIkV4dGVuZGVkIFJlbGVhc2UgT3Bpb2lkIFByZXNjcmlwdGlvbiBJc3N1ZSI6CiAgICBEZXRlY3RlZElzc3VlIHsKICAgICAgLy9pZGVudGlmaWVyOiwKICAgICAgc3RhdHVzOiBGSElSLk9ic2VydmF0aW9uU3RhdHVzIHsgdmFsdWU6ICdwcmVsaW1pbmFyeScgfSwKICAgICAgY2F0ZWdvcnk6IEZISVIuQ29kZWFibGVDb25jZXB0IHsgdGV4dDogRkhJUi5zdHJpbmcgeyB2YWx1ZTogIkdldCBTdW1tYXJ5IiB9IH0sCiAgICAgIHNldmVyaXR5OiBGSElSLkRldGVjdGVkSXNzdWVTZXZlcml0eSB7IHZhbHVlOiAnbW9kZXJhdGUnIH0sCiAgICAgIHBhdGllbnQ6IEZISVIuUmVmZXJlbmNlIHsgcmVmZXJlbmNlOiBGSElSLnN0cmluZyB7IHZhbHVlOiAnUGF0aWVudC8nICsgUGF0aWVudC5pZCB9IH0sCiAgICAgIGRhdGU6IEZISVIuZGF0ZVRpbWUgeyB2YWx1ZTogTm93KCkgfSwKICAgICAgLy8gVE9ETzogRGV2aWNlIHJlcHJlc2VudGF0aW9uLi4uCiAgICAgIC8vIGF1dGhvcjosCiAgICAgIGltcGxpY2F0ZWQ6CiAgICAgICAgKCJDaHJvbmljIFBhaW4gRXh0ZW5kZWQgUmVsZWFzZSBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIFByZXNjcmlwdGlvbnMiKSBNCiAgICAgICAgICByZXR1cm4gRkhJUi5SZWZlcmVuY2UgeyByZWZlcmVuY2U6IEZISVIuc3RyaW5nIHsgdmFsdWU6ICdNZWRpY2F0aW9uUmVxdWVzdC8nICsgTS5pZCB9IH0sCiAgICAgIGRldGFpbDogRkhJUi5zdHJpbmcgeyB2YWx1ZTogIkdldCBEZXRhaWwiIH0sCiAgICAgIHJlZmVyZW5jZTogRkhJUi51cmkgeyB2YWx1ZTogJ2h0dHA6Ly9maGlyLm9yZy9ndWlkZXMvY2RjL29waW9pZC1jZHMvUGxhbkRlZmluaXRpb24vb3Bpb2lkY2RzLTA0LXBhdGllbnQtdmlldyd9CiAgICB9Cg=="
  } ]
}