{
  "resourceType": "Library",
  "id": "library-OpioidCDSREC10",
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/cdc/opioid-cds/Library/OpioidCDSREC10",
  "version": "2.0.1",
  "name": "OpioidCDSREC10",
  "relatedArtifact": [ {
    "type": "depends-on",
    "display": "FHIR model information"
  }, {
    "type": "depends-on",
    "display": "Library FHIRHelpers"
  }, {
    "type": "depends-on",
    "display": "Library Common"
  }, {
    "type": "depends-on",
    "display": "Library Config"
  }, {
    "type": "depends-on",
    "display": "Library Routines"
  }, {
    "type": "depends-on",
    "display": "Value set Opioid analgesics with ambulatory misuse potential"
  }, {
    "type": "depends-on",
    "display": "Value set Community"
  }, {
    "type": "depends-on",
    "display": "Value set Observation Category Laboratory"
  }, {
    "type": "depends-on",
    "display": "Value set Non-opioid drug urine screening"
  }, {
    "type": "depends-on",
    "display": "Value set Opioid drug urine screening"
  }, {
    "type": "depends-on",
    "display": "Value set Cocaine Urine Tests"
  }, {
    "type": "depends-on",
    "display": "Value set PCP Urine Tests"
  }, {
    "type": "depends-on",
    "display": "Value set Encounter Diagnosis Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Problem List Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set US Core Health Concern Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Limited life expectancy conditions"
  }, {
    "type": "depends-on",
    "display": "Value set Active Condition"
  }, {
    "type": "depends-on",
    "display": "Value set Therapies indicating end of life care"
  }, {
    "type": "depends-on",
    "display": "Value set Conditions likely terminal for opioid prescribing"
  }, {
    "type": "depends-on",
    "display": "Value set Hospice Procedure Codes"
  } ],
  "parameter": [ {
    "name": "ContextPrescriptions",
    "use": "in",
    "min": 0,
    "max": "*",
    "type": "MedicationRequest"
  }, {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Patient"
  }, {
    "name": "Lookback Year",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Period"
  }, {
    "name": "Chronic Pain Opioid Analgesic with Ambulatory Misuse Potential Prescriptions",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "MedicationRequest"
  }, {
    "name": "Patient Is Being Prescribed Opioid Analgesic with Ambulatory Misuse Potential",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Age Less Than 18",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Non-opioid Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Opioid Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Cocaine Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "PCP Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Urine Screenings during the Last 12 Months",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Patient had Urine Screening in Last 12 Months",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Has Positive Screening for Cocaine in Last 12 Months",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Has Positive Screening for PCP in Last 12 Months",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Inclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Exclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Is Recommendation Applicable?",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Positive PCP Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Negative PCP Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Positive Cocaine Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Negative Cocaine Screenings",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Negative PCP Screenings Count Since Last Positive Screening",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "integer"
  }, {
    "name": "Negative Cocaine Screenings Count Since Last Positive Screening",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "integer"
  }, {
    "name": "Positive Cocaine Dates in Lookback Period",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "string"
  }, {
    "name": "Positive PCP Dates in Lookback Period",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "string"
  }, {
    "name": "Applicable Because of Positive Cocaine or PCP",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Applicable Not Because of Positive Cocaine or PCP",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Cocaine Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "PCP Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Cocaine And PCP Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Detail",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Indicator",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  } ],
  "dataRequirement": [ {
    "type": "Patient",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "code", "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "code", "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "mustSupport": [ "code", "status.value", "status" ],
    "codeFilter": [ {
      "path": "code"
    } ]
  }, {
    "type": "ServiceRequest",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/ServiceRequest" ],
    "mustSupport": [ "code", "status.value", "status" ],
    "codeFilter": [ {
      "path": "code"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Encounter" ],
    "mustSupport": [ "period.start", "period", "status.value", "status" ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "mustSupport": [ "effective", "code", "category", "value" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBPcGlvaWRDRFNSRUMxMCB2ZXJzaW9uICcxLjIuMycKCnVzaW5nIEZISVIgdmVyc2lvbiAnMy4wLjAnCgppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzMuMC4wJyBjYWxsZWQgRkhJUkhlbHBlcnMKaW5jbHVkZSBPcGlvaWRDRFNDb21tb24gdmVyc2lvbiAnMS4yLjMnIGNhbGxlZCBDb21tb24KaW5jbHVkZSBPcGlvaWRDRFNSb3V0aW5lcyB2ZXJzaW9uICcxLjIuMycgY2FsbGVkIFJvdXRpbmVzCmluY2x1ZGUgT3Bpb2lkQ0RTQ29tbW9uQ29uZmlnIHZlcnNpb24gJzEuMi4zJyBjYWxsZWQgQ29uZmlnCgovKgoqKiAgUmVjb21tZW5kYXRpb24gIzEwCioqICAgIFdoZW4gcHJlc2NyaWJpbmcgb3Bpb2lkcyBmb3IgY2hyb25pYyBwYWluLCBwcm92aWRlcnMgc2hvdWxkIHVzZSB1cmluZSBkcnVnCioqICAgIHRlc3RpbmcgYmVmb3JlIHN0YXJ0aW5nIG9waW9pZCB0aGVyYXB5IGFuZCBjb25zaWRlciB1cmluZSBkcnVnIHRlc3RpbmcgYXQKKiogICAgbGVhc3QgYW5udWFsbHkgdG8gYXNzZXNzIGZvciBwcmVzY3JpYmVkIG1lZGljYXRpb25zIGFzIHdlbGwgYXMgb3RoZXIgY29udHJvbGxlZAoqKiAgICBwcmVzY3JpcHRpb24gZHJ1Z3MgYW5kIGlsbGljaXQgZHJ1Z3MgKHJlY29tbWVuZGF0aW9uIGNhdGVnb3J5OiBCLCBldmlkZW5jZSB0eXBlOiA0KQoqKgoqKiAgV2hlbgoqKiAgICBQcm92aWRlciBpcyBwcmVzY3JpYmluZyBhbiBvcGlvaWQgYW5hbGdlc2ljIHdpdGggYW1idWxhdG9yeSBtaXN1c2UgcG90ZW50aWFsIGluIHRoZSBvdXRwYXRpZW50IHNldHRpbmcKKiogICAgUHJlc2NyaXB0aW9uIGlzIGZvciB0cmVhdGluZyBjaHJvbmljIHBhaW4uCioqICAgIE9waW9pZCByZXZpZXcgaXMgdXNlZnVsIGZvciB0aGlzIHBhdGllbnQ6CioqICAgICAgUGF0aWVudCBpcyAxOCBvciBvdmVyCioqICAgICAgUGF0aWVudCBkb2VzIG5vdCBoYXZlIGZpbmRpbmdzIGluZGljYXRpbmcgbGltaXRlZCBsaWZlIGV4cGVjdGFuY3kKKiogICAgICBQYXRpZW50IGRvZXMgbm90IGhhdmUgb3JkZXJzIGZvciB0aGVyYXBpZXMgaW5kaWNhdGluZyBlbmQgb2YgbGlmZSBjYXJlCioqICAgICAgUGF0aWVudCBpcyBub3QgdW5kZXJnb2luZyBhY3RpdmUgY2FuY2VyIHRyZWF0bWVudDoKKiogICAgICAgIFBhdGllbnQgaGFzIGhhZCBhdCBsZWFzdCAyIGVuY291bnRlcnMgd2l0aGluIHRoZSBwYXN0IHllYXIgd2l0aCBhbnkgZGlhZ25vc2lzIG9mIGNhbmNlcgoqKiAgICBVcmluZSBkcnVnIHNjcmVlbmluZyBoYXMgbm90IGJlZW4gcGVyZm9ybWVkIGluIGxhc3QgMTIgbW9udGhzCioqICBUaGVuCioqICAgIFJlY29tbWVuZCB1cmluZSBkcnVnIHNjcmVlbmluZwoqKiAgICAgIFdpbGwgcGVyZm9ybSB1cmluZSBzY3JlZW5pbmcKKiogICAgICBOb3QgZm9yIGNocm9uaWMgcGFpbiBtYW5hZ2VtZW50LCBzbm9vemUgMyBtb250aHMKKiogICAgICBOL0EgLSBzZWUgY29tbWVudCwgc25vb3plIDMgbW9udGhzCioqCiovCgovLyBNRVRBOiBQbGFuIERlZmluaXRpb246IGh0dHA6Ly9maGlyLm9yZy9ndWlkZXMvY2RjL29waW9pZC1jZHMvUGxhbkRlZmluaXRpb24vb3Bpb2lkLWNkcy0xMAoKcGFyYW1ldGVyIERyYWZ0T3JkZXJzIExpc3Q8Q2hvaWNlPE1lZGljYXRpb25SZXF1ZXN0LCBQcm9jZWR1cmVSZXF1ZXN0LCBSZWZlcnJhbFJlcXVlc3QsIFZpc2lvblByZXNjcmlwdGlvbiwgTnV0cml0aW9uT3JkZXI+PgoKY29udGV4dCBQYXRpZW50CgpkZWZpbmUgIkxvb2tiYWNrIFllYXIiOgogIEludGVydmFsW1RvZGF5KCkgLSAxMiBtb250aHMgLSAxIGRheXMsIFRvZGF5KCkgLSAxIGRheV0KCmRlZmluZSAiQ29udGV4dFByZXNjcmlwdGlvbnMiOgogIERyYWZ0T3JkZXJzIE8KICB3aGVyZSBPIGlzIE1lZGljYXRpb25SZXF1ZXN0CgpkZWZpbmUgIkNocm9uaWMgUGFpbiBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIFByZXNjcmlwdGlvbnMiOgogIChDb21tb24uIklzIE9waW9pZCBBbmFsZ2VzaWMgd2l0aCBBbWJ1bGF0b3J5IE1pc3VzZSBQb3RlbnRpYWw/IihDb250ZXh0UHJlc2NyaXB0aW9ucykpIEFtYnVsYXRvcnlPcGlvaWRQcmVzY3JpcHRpb24KICAgIHdoZXJlIFJvdXRpbmVzLiJJcyBDaHJvbmljIFBhaW4gUHJlc2NyaXB0aW9uPyIoQW1idWxhdG9yeU9waW9pZFByZXNjcmlwdGlvbikKCmRlZmluZSAiUGF0aWVudCBJcyBCZWluZyBQcmVzY3JpYmVkIE9waW9pZCBBbmFsZ2VzaWMgd2l0aCBBbWJ1bGF0b3J5IE1pc3VzZSBQb3RlbnRpYWwiOgogIGV4aXN0cyAoIkNocm9uaWMgUGFpbiBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIFByZXNjcmlwdGlvbnMiKQoKZGVmaW5lICJJcyBSZWNvbW1lbmRhdGlvbiBBcHBsaWNhYmxlPyI6CiAgIkluY2x1c2lvbiBDcml0ZXJpYSIKICAgIGFuZCBub3QgIkV4Y2x1c2lvbiBDcml0ZXJpYSIKCmRlZmluZSAiUGF0aWVudCBBZ2UgTGVzcyBUaGFuIDE4IjoKICBpZiAoQ29uZmlnLiJBZ2UgTGVzcyB0aGFuIDE4IFllYXJzIElzIEVuYWJsZWQiKSB0aGVuCiAgICBBZ2VJblllYXJzQXQoVG9kYXkoKSkgPCAxOAogIGVsc2UKICAgIGZhbHNlCgpkZWZpbmUgIkluY2x1c2lvbiBDcml0ZXJpYSI6CiAgIlBhdGllbnQgSXMgQmVpbmcgUHJlc2NyaWJlZCBPcGlvaWQgQW5hbGdlc2ljIHdpdGggQW1idWxhdG9yeSBNaXN1c2UgUG90ZW50aWFsIgogICAgYW5kIG5vdCAiUGF0aWVudCBBZ2UgTGVzcyBUaGFuIDE4IgogICAgYW5kIFJvdXRpbmVzLiJJcyBPcGlvaWQgUmV2aWV3IFVzZWZ1bD8iCiAgICBhbmQgKG5vdCAiUGF0aWVudCBoYWQgVXJpbmUgU2NyZWVuaW5nIGluIExhc3QgMTIgTW9udGhzIgogICAgICBvciAiSGFzIFBvc2l0aXZlIFNjcmVlbmluZyBmb3IgQ29jYWluZSBpbiBMYXN0IDEyIE1vbnRocyIKICAgICAgb3IgIkhhcyBQb3NpdGl2ZSBTY3JlZW5pbmcgZm9yIFBDUCBpbiBMYXN0IDEyIE1vbnRocyIpCgpkZWZpbmUgIkV4Y2x1c2lvbiBDcml0ZXJpYSI6CiAgZmFsc2UKCmRlZmluZSAiUGF0aWVudCBoYWQgVXJpbmUgU2NyZWVuaW5nIGluIExhc3QgMTIgTW9udGhzIjoKICBleGlzdHMgKCJVcmluZSBTY3JlZW5pbmdzIGR1cmluZyB0aGUgTGFzdCAxMiBNb250aHMiKQoKZGVmaW5lICJVcmluZSBTY3JlZW5pbmdzIGR1cmluZyB0aGUgTGFzdCAxMiBNb250aHMiOgogICJOb24tb3Bpb2lkIFNjcmVlbmluZ3MiCiAgICB1bmlvbiAiT3Bpb2lkIFNjcmVlbmluZ3MiCiAgICB1bmlvbiAiQ29jYWluZSBTY3JlZW5pbmdzIgogICAgdW5pb24gIlBDUCBTY3JlZW5pbmdzIgoKZGVmaW5lICJMYWJvcmF0b3J5IE9ic2VydmF0aW9ucyI6CiAgICBbT2JzZXJ2YXRpb246ICJjYXRlZ29yeSIgaW4gQ29tbW9uLiJPYnNlcnZhdGlvbiBDYXRlZ29yeSBMYWJvcmF0b3J5Il0KCmRlZmluZSAiTm9uLW9waW9pZCBTY3JlZW5pbmdzIjoKICBHZXRSZWxldmFudFNjcmVlbmluZ3MoIkxhYm9yYXRvcnkgT2JzZXJ2YXRpb25zIiBMYWJPYnNlcnZhdGlvbnMKICAgICAgd2hlcmUgKExhYk9ic2VydmF0aW9ucy5jb2RlIGluIENvbW1vbi4iTm9uLW9waW9pZCBkcnVnIHVyaW5lIHNjcmVlbmluZyIpCiAgKQoKZGVmaW5lICJPcGlvaWQgU2NyZWVuaW5ncyI6CiAgR2V0UmVsZXZhbnRTY3JlZW5pbmdzKCJMYWJvcmF0b3J5IE9ic2VydmF0aW9ucyIgTGFiT2JzZXJ2YXRpb25zCiAgICAgIHdoZXJlIChMYWJPYnNlcnZhdGlvbnMuY29kZSBpbiBDb21tb24uIk9waW9pZCBkcnVnIHVyaW5lIHNjcmVlbmluZyIpCiAgKQoKZGVmaW5lICJDb2NhaW5lIFNjcmVlbmluZ3MiOgogIEdldFJlbGV2YW50U2NyZWVuaW5ncygiTGFib3JhdG9yeSBPYnNlcnZhdGlvbnMiIExhYk9ic2VydmF0aW9ucwogICAgICB3aGVyZSAoTGFiT2JzZXJ2YXRpb25zLmNvZGUgaW4gQ29tbW9uLiJDb2NhaW5lIFVyaW5lIFRlc3RzIikKICApCgpkZWZpbmUgIlBDUCBTY3JlZW5pbmdzIjoKICBHZXRSZWxldmFudFNjcmVlbmluZ3MoIkxhYm9yYXRvcnkgT2JzZXJ2YXRpb25zIiBMYWJPYnNlcnZhdGlvbnMKICAgICAgd2hlcmUgKExhYk9ic2VydmF0aW9ucy5jb2RlIGluIENvbW1vbi4iUENQIFVyaW5lIFRlc3RzIikKICApCgpkZWZpbmUgZnVuY3Rpb24gR2V0UmVsZXZhbnRTY3JlZW5pbmdzKG9ic0xpc3QgTGlzdDxPYnNlcnZhdGlvbj4pOgogIG9ic0xpc3QgTGFiT2JzZXJ2YXRpb25zCiAgICAgd2hlcmUgZGF0ZSBmcm9tIExhYk9ic2VydmF0aW9ucy5lZmZlY3RpdmUgaW4gZGF5IG9mICJMb29rYmFjayBZZWFyIgogICAgICAgYW5kIG5vdCAoTGFiT2JzZXJ2YXRpb25zLnN0YXR1cy52YWx1ZSBpbiB7ICd1bmtub3duJywgJ2VudGVyZWQtaW4tZXJyb3InLCAnY2FuY2VsbGVkJyB9KQoKLy8gUmV0dXJucyBhIHRleHQgcmVwcmVzZW50YXRpb24gb2YgYSBkYXRlVGltZSB1c2luZyB0aGUgQ1FMIGBUb1N0cmluZ2AgZnVuY3Rpb24uCi8vIEBwYXJhbSBkIC0gYSBGSElSIGRhdGVUaW1lIHRvIGdldCB0ZXh0IGZvcgovLyBAcmV0dXJucyB7U3lzdGVtLlN0cmluZ30gdGhlIHRleHQgcmVwcmVzZW50YXRpb24gb2YgdGhlIGRhdGVUaW1lCmRlZmluZSBmdW5jdGlvbiBEYXRlVGltZVRleHQoZCBGSElSLmRhdGVUaW1lKToKICBUb1N0cmluZyhkLnZhbHVlKQoKZGVmaW5lICJQb3NpdGl2ZSBQQ1AgU2NyZWVuaW5ncyI6CiAgIlBDUCBTY3JlZW5pbmdzIiBQQ1Agd2hlcmUKICAgIFN0YXJ0c1dpdGgoTG93ZXIoUENQLnZhbHVlIGFzIEZISVIuc3RyaW5nKSwgJ3BvcycpCgpkZWZpbmUgIk5lZ2F0aXZlIFBDUCBTY3JlZW5pbmdzIjoKICAiUENQIFNjcmVlbmluZ3MiIFBDUCB3aGVyZQogICAgU3RhcnRzV2l0aChMb3dlcihQQ1AudmFsdWUgYXMgRkhJUi5zdHJpbmcpLCAnbmVnJykKCmRlZmluZSAiUG9zaXRpdmUgQ29jYWluZSBTY3JlZW5pbmdzIjoKICAiQ29jYWluZSBTY3JlZW5pbmdzIiBDb2NhaW5lIHdoZXJlCiAgICBTdGFydHNXaXRoKExvd2VyKENvY2FpbmUudmFsdWUgYXMgRkhJUi5zdHJpbmcpLCAncG9zJykKCmRlZmluZSAiTmVnYXRpdmUgQ29jYWluZSBTY3JlZW5pbmdzIjoKICAiQ29jYWluZSBTY3JlZW5pbmdzIiBDb2NhaW5lIHdoZXJlCiAgICBTdGFydHNXaXRoKExvd2VyKENvY2FpbmUudmFsdWUgYXMgRkhJUi5zdHJpbmcpLCAnbmVnJykKCi8qCiAgYm9ycm93ZWQgZnJvbSBDRFM0Q1BNIENEU19Db25uZWN0X0NvbW1vbnNfZm9yX0ZISVJ2NDAwCiAgU2hvdWRsIHRoaXMgZ28gaW50byBPcGlvaWRDRFNDb21tb24/CiovCmRlZmluZSBmdW5jdGlvbiBNb3N0UmVjZW50KE9ic0xpc3QgTGlzdDxPYnNlcnZhdGlvbj4pOgogIExhc3QoT2JzTGlzdCBPIHNvcnQgYnkgQ29hbGVzY2UoCiAgICAoZWZmZWN0aXZlIGFzIEZISVIuZGF0ZVRpbWUpLnZhbHVlLAogICAgKGVmZmVjdGl2ZSBhcyBGSElSLlBlcmlvZCkuImVuZCIudmFsdWUsCiAgICAoZWZmZWN0aXZlIGFzIEZISVIuUGVyaW9kKS4ic3RhcnQiLnZhbHVlLAogICAgaXNzdWVkLnZhbHVlKQogICkKCmRlZmluZSAiTmVnYXRpdmUgUENQIFNjcmVlbmluZ3MgQ291bnQgU2luY2UgTGFzdCBQb3NpdGl2ZSBTY3JlZW5pbmciOgogIENvdW50KAogICAgIk5lZ2F0aXZlIFBDUCBTY3JlZW5pbmdzIiBOIHdoZXJlCiAgICAgIERhdGVUaW1lVGV4dChOLmVmZmVjdGl2ZSkgPiAgRGF0ZVRpbWVUZXh0KCJNb3N0UmVjZW50IigiUG9zaXRpdmUgUENQIFNjcmVlbmluZ3MiKS5lZmZlY3RpdmUpCiAgKQoKZGVmaW5lICJOZWdhdGl2ZSBDb2NhaW5lIFNjcmVlbmluZ3MgQ291bnQgU2luY2UgTGFzdCBQb3NpdGl2ZSBTY3JlZW5pbmciOgogIENvdW50KAogICAgIk5lZ2F0aXZlIENvY2FpbmUgU2NyZWVuaW5ncyIgTiB3aGVyZQogICAgICBEYXRlVGltZVRleHQoTi5lZmZlY3RpdmUpID4gIERhdGVUaW1lVGV4dCgiTW9zdFJlY2VudCIoIlBvc2l0aXZlIENvY2FpbmUgU2NyZWVuaW5ncyIpLmVmZmVjdGl2ZSkKICApCgpkZWZpbmUgIlBvc2l0aXZlIENvY2FpbmUgRGF0ZXMgaW4gTG9va2JhY2sgUGVyaW9kIjoKICAiUG9zaXRpdmUgQ29jYWluZSBTY3JlZW5pbmdzIiBDUwogICAgcmV0dXJuCiAgICAgIERhdGVUaW1lVGV4dChDUy5lZmZlY3RpdmUpCgpkZWZpbmUgIlBvc2l0aXZlIFBDUCBEYXRlcyBpbiBMb29rYmFjayBQZXJpb2QiOgogICJQb3NpdGl2ZSBQQ1AgU2NyZWVuaW5ncyIgUFMKICAgIHJldHVybgogICAgICBEYXRlVGltZVRleHQoUFMuZWZmZWN0aXZlKQoKZGVmaW5lICJIYXMgUG9zaXRpdmUgU2NyZWVuaW5nIGZvciBDb2NhaW5lIGluIExhc3QgMTIgTW9udGhzIjoKICBleGlzdHMgIkNvY2FpbmUgU2NyZWVuaW5ncyIgQ1Mgd2hlcmUKICAgICBTdGFydHNXaXRoKExvd2VyKENTLnZhbHVlIGFzIEZISVIuc3RyaW5nKSwgJ3BvcycpCgpkZWZpbmUgIkhhcyBQb3NpdGl2ZSBTY3JlZW5pbmcgZm9yIFBDUCBpbiBMYXN0IDEyIE1vbnRocyI6CiAgZXhpc3RzICJQQ1AgU2NyZWVuaW5ncyIgUENQIHdoZXJlCiAgICBTdGFydHNXaXRoKExvd2VyKFBDUC52YWx1ZSBhcyBGSElSLnN0cmluZyksICdwb3MnKQoKZGVmaW5lICJBcHBsaWNhYmxlIEJlY2F1c2Ugb2YgUG9zaXRpdmUgQ29jYWluZSBvciBQQ1AiOgogICJJcyBSZWNvbW1lbmRhdGlvbiBBcHBsaWNhYmxlPyIKICAgIGFuZCAoIkhhcyBQb3NpdGl2ZSBTY3JlZW5pbmcgZm9yIENvY2FpbmUgaW4gTGFzdCAxMiBNb250aHMiIG9yICJIYXMgUG9zaXRpdmUgU2NyZWVuaW5nIGZvciBQQ1AgaW4gTGFzdCAxMiBNb250aHMiKQoKZGVmaW5lICJBcHBsaWNhYmxlIE5vdCBCZWNhdXNlIG9mIFBvc2l0aXZlIENvY2FpbmUgb3IgUENQIjoKICAiSXMgUmVjb21tZW5kYXRpb24gQXBwbGljYWJsZT8iCiAgICBhbmQgbm90ICJIYXMgUG9zaXRpdmUgU2NyZWVuaW5nIGZvciBDb2NhaW5lIGluIExhc3QgMTIgTW9udGhzIgogICAgYW5kIG5vdCAiSGFzIFBvc2l0aXZlIFNjcmVlbmluZyBmb3IgUENQIGluIExhc3QgMTIgTW9udGhzIgoKZGVmaW5lICJEZXRhaWwiOgogIGlmICJBcHBsaWNhYmxlIEJlY2F1c2Ugb2YgUG9zaXRpdmUgQ29jYWluZSBvciBQQ1AiCiAgICB0aGVuCiAgICAgICgKICAgICAgICBpZiAoIkhhcyBQb3NpdGl2ZSBTY3JlZW5pbmcgZm9yIENvY2FpbmUgaW4gTGFzdCAxMiBNb250aHMiIGFuZCAiSGFzIFBvc2l0aXZlIFNjcmVlbmluZyBmb3IgUENQIGluIExhc3QgMTIgTW9udGhzIikKICAgICAgICAgIHRoZW4gIkNvY2FpbmUgQW5kIFBDUCBTdW1tYXJ5IgogICAgICAgIGVsc2UgaWYgIkhhcyBQb3NpdGl2ZSBTY3JlZW5pbmcgZm9yIENvY2FpbmUgaW4gTGFzdCAxMiBNb250aHMiCiAgICAgICAgICB0aGVuICJDb2NhaW5lIFN1bW1hcnkiCiAgICAgICAgZWxzZSBpZiAiSGFzIFBvc2l0aXZlIFNjcmVlbmluZyBmb3IgUENQIGluIExhc3QgMTIgTW9udGhzIgogICAgICAgICAgdGhlbiAiUENQIFN1bW1hcnkiCiAgICAgICAgZWxzZQogICAgICAgICAgJ05vIERldGFpbHMgQXZhaWxhYmxlJwogICAgICApCiAgZWxzZSBpZiAiQXBwbGljYWJsZSBOb3QgQmVjYXVzZSBvZiBQb3NpdGl2ZSBDb2NhaW5lIG9yIFBDUCIKICAgIHRoZW4gJ1BhdGllbnRzIG9uIG9waW9pZCB0aGVyYXB5IHNob3VsZCBoYXZlIGEgdXJpbmUgZHJ1ZyB0ZXN0IHBlcmZvcm1lZCBldmVyeSAxMiBtb250aHMuJwogICAgZWxzZSBudWxsCgpkZWZpbmUgIkluZGljYXRvciI6CiAgJ3dhcm5pbmcnCgpkZWZpbmUgIlN1bW1hcnkiOgogIGlmICJBcHBsaWNhYmxlIEJlY2F1c2Ugb2YgUG9zaXRpdmUgQ29jYWluZSBvciBQQ1AiCiAgICB0aGVuICdQb3NpdGl2ZSBDb2NhaW5lIG9yIFBDUCBpbiBVcmluZSBTY3JlZW5pbmcnCiAgZWxzZSBpZiAiQXBwbGljYWJsZSBOb3QgQmVjYXVzZSBvZiBQb3NpdGl2ZSBDb2NhaW5lIG9yIFBDUCIKICAgIHRoZW4gJ0FubnVhbCBVcmluZSBTY3JlZW5pbmcgQ2hlY2snCiAgZWxzZSBudWxsCgpkZWZpbmUgIlVyaW5lIERydWcgU2NyZWVuaW5nIFByb2NlZHVyZVJlcXVlc3QgQ2F0ZWdvcnkiOgogIEZISVIuQ29kZWFibGVDb25jZXB0IHsKICAgIGNvZGluZzogewogICAgICBGSElSLkNvZGluZyB7CiAgICAgICAgc3lzdGVtOiBGSElSLnVyaSB7IHZhbHVlOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9tZWRpY2F0aW9ucmVxdWVzdC1jYXRlZ29yeScgfSwKICAgICAgICBjb2RlOiBGSElSLmNvZGUgeyB2YWx1ZTogJ291dHBhdGllbnQnIH0sCiAgICAgICAgZGlzcGxheTogRkhJUi5zdHJpbmcgeyB2YWx1ZTogJ091dHBhdGllbnQnIH0KICAgICAgfQogICAgfQogIH0KICAvKiBzaW5nbGV0b24gZnJvbSAoRmlyc3QoCiAgICBbRW5jb3VudGVyXSBFCiAgICAgIHdoZXJlIEUucGVyaW9kIHN0YXJ0cyBzYW1lIGRheSBhcyBUb2RheSgpCiAgICAgIHNvcnQgYnkgc3RhcnQgb2YgcGVyaW9kIGRlc2MKICApLnR5cGUpICovCgpkZWZpbmUgIkNvY2FpbmUgQW5kIFBDUCBTdW1tYXJ5IjoKICAnUG9zaXRpdmUgZm9yIENvY2FpbmUgQU5EIFBDUCA8YnIvPjxici8+JyArCiAgICAiQ29jYWluZSBTdW1tYXJ5IiArICc8YnIvPicgKyAiUENQIFN1bW1hcnkiCgpkZWZpbmUgIlBDUCBTdW1tYXJ5IjoKICAnUG9zaXRpdmUgZm9yIFBDUDogPGJyLz4nICsKICAnUG9zaXRpdmUgbGFiIGRhdGVzOiA8YnIvPicgKyBDb21iaW5lKCJQb3NpdGl2ZSBQQ1AgRGF0ZXMgaW4gTG9va2JhY2sgUGVyaW9kIiwgJywgPGJyLz4nKSArICc8YnIvPicgKwogICdOZWdhdGl2ZSB0ZXN0IGNvdW50IHNpbmNlIGxhc3QgUG9zaXRpdmU6ICcgKyBUb1N0cmluZygiTmVnYXRpdmUgUENQIFNjcmVlbmluZ3MgQ291bnQgU2luY2UgTGFzdCBQb3NpdGl2ZSBTY3JlZW5pbmciKQoKZGVmaW5lICJDb2NhaW5lIFN1bW1hcnkiOgogICdQb3NpdGl2ZSBmb3IgQ29jYWluZTogPGJyLz4nICsKICAnUG9zaXRpdmUgbGFiIGRhdGVzOiA8YnIvPicgKyBDb21iaW5lKCJQb3NpdGl2ZSBDb2NhaW5lIERhdGVzIGluIExvb2tiYWNrIFBlcmlvZCIsICc8YnIvPicpICsgJzxici8+JyArCiAgJ05lZ2F0aXZlIHRlc3QgY291bnQgc2luY2UgbGFzdCBQb3NpdGl2ZTogJyArIFRvU3RyaW5nKCJOZWdhdGl2ZSBDb2NhaW5lIFNjcmVlbmluZ3MgQ291bnQgU2luY2UgTGFzdCBQb3NpdGl2ZSBTY3JlZW5pbmciKQo="
  } ]
}