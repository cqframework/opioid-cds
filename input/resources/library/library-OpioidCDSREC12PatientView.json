{
  "resourceType": "Library",
  "id": "library-OpioidCDSREC12PatientView",
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/cdc/opioid-cds/Library/OpioidCDSREC12PatientView",
  "version": "2.0.1",
  "name": "OpioidCDSREC12PatientView",
  "relatedArtifact": [ {
    "type": "depends-on",
    "display": "FHIR model information"
  }, {
    "type": "depends-on",
    "display": "Library FHIRHelpers"
  }, {
    "type": "depends-on",
    "display": "Library Common"
  }, {
    "type": "depends-on",
    "display": "Library Config"
  }, {
    "type": "depends-on",
    "display": "Value set Buprenorphine and methadone medications"
  }, {
    "type": "depends-on",
    "display": "Value set Substance misuse behavioral counseling"
  }, {
    "type": "depends-on",
    "display": "Value set Encounter Diagnosis Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Problem List Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set US Core Health Concern Condition Category"
  }, {
    "type": "depends-on",
    "display": "Value set Opioid misuse disorders"
  }, {
    "type": "depends-on",
    "display": "Value set Active Condition"
  } ],
  "parameter": [ {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Patient"
  }, {
    "name": "Opioid Use Disorder Lookback Period",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Period"
  }, {
    "name": "Patient 18 or Older?",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Not Receiving Evidence-Based Treatment for Opioid Use Disorder",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Presence of Diagnosis of Opioid Use Disorder",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Positive Result from Opioid Use Disorder Evaluation Tool",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Inclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Exclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Is Recommendation Applicable?",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Get Indicator",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Get Summary",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Get Detail",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Any"
  } ],
  "dataRequirement": [ {
    "type": "Patient",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/MedicationRequest" ],
    "mustSupport": [ "authoredOn", "medication", "status" ],
    "codeFilter": [ {
      "path": "medication"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "mustSupport": [ "code", "performed", "status" ],
    "codeFilter": [ {
      "path": "code"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "mustSupport": [ "category" ],
    "codeFilter": [ {
      "path": "category"
    } ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBPcGlvaWRDRFNSRUMxMlBhdGllbnRWaWV3IHZlcnNpb24gJzEuMi4zJwoKdXNpbmcgRkhJUiB2ZXJzaW9uICczLjAuMCcKCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnMy4wLjAnIGNhbGxlZCBGSElSSGVscGVycwppbmNsdWRlIE9waW9pZENEU0NvbW1vbiB2ZXJzaW9uICcxLjIuMycgY2FsbGVkIENvbW1vbgppbmNsdWRlIE9waW9pZENEU0NvbW1vbkNvbmZpZyB2ZXJzaW9uICcxLjIuMycgY2FsbGVkIENvbmZpZwoKLyoKKioKKiogIFJlY29tbWVuZGF0aW9uICMxMgoqKiAgICBDbGluaWNpYW5zIHNob3VsZCBvZmZlciBvciBhcnJhbmdlIGV2aWRlbmNlLWJhc2VkIHRyZWF0bWVudCAodXN1YWxseQoqKiAgICBtZWRpY2F0aW9uLWFzc2lzdGVkIHRyZWF0bWVudCB3aXRoIGJ1cHJlbm9ycGhpbmUgb3IgbWV0aGFkb25lIGluIGNvbWJpbmF0aW9uCioqICAgIHdpdGggYmVoYXZpb3JhbCB0aGVyYXBpZXMpIGZvciBwYXRpZW50cyB3aXRoIG9waW9pZCB1c2UgZGlzb3JkZXIKKiogICAgKHJlY29tbWVuZGF0aW9uIGNhdGVnb3J5OiBBLCBldmlkZW5jZSB0eXBlOiAyKQoqKgoqKiAgV2hlbgoqKiAgICBQYXRpZW50IGlzIDE4IHllYXJzIGFuZCBvbGRlciBhbmQgbm90IHJlY2VpdmluZyBldmlkZW5jZS1iYXNlZCB0cmVhdG1lbnQgZm9yCioqICAgICAgb3Bpb2lkIHVzZSBkaXNvcmRlciwgd2hpY2ggbWF5IGluY2x1ZGUgbWVkaWNhdGlvbiB0cmVhdG1lbnQgd2l0aCBidXByZW5vcnBoaW5lCioqICAgICAgb3IgbWV0aGFkb25lLCBvciBvcGlvaWQtc3BlY2lmaWMgYmVoYXZpb3JhbCBjb3Vuc2VsaW5nCioqICAgIFBhdGllbnQgaGFzIGEgZGlhZ25vc2lzIG9mIG9waW9pZCB1c2UgZGlzb3JkZXIgaW4gdGhlIHBhc3QgOTAgZGF5cwoqKiAgVGhlbgoqKiAgICBSZWNvbW1lbmQgb3Bpb2lkIGFnb25pc3Qgb3IgcGFydGlhbCBhZ29uaXN0IHRyZWF0bWVudCB3aXRoIG1ldGhhZG9uZSBtYWludGVuYW5jZQoqKiAgICB0aGVyYXB5LCBidXByZW5vcnBoaW5lIHRoZXJhcHksIGFuZC9vciBiZWhhdmlvcmFsIHRoZXJhcHkuIFBvdGVudGlhbCBhY3Rpb25zIGluY2x1ZGU6CioqICAgICAgT3JkZXIgbWV0aGFkb25lIG9yIGJ1cHJlbm9ycGhpbmUKKiogICAgICBSZWZlciB0byBxdWFsaWZpZWQgdHJlYXRtZW50IHByb3ZpZGVyIChpLmUuIHN1YnN0YW5jZSBkaXNvcmRlciBzcGVjaWFsaXN0KQoqKiAgICAgIE4vQSAtIHNlZSBjb21tZW50OyBzbm9vemUgMyBtb250aHMKKioKKi8KCi8vIE1FVEE6IFBsYW5EZWZpbml0aW9uOiBodHRwOi8vZmhpci5vcmcvZ3VpZGVzL2NkYy9vcGlvaWQtY2RzL1BsYW5EZWZpbml0aW9uL29waW9pZC1jZHMtMTItcGF0aWVudC12aWV3Cgpjb250ZXh0IFBhdGllbnQKCmRlZmluZSAiT3Bpb2lkIFVzZSBEaXNvcmRlciBMb29rYmFjayBQZXJpb2QiOgogIEludGVydmFsW1RvZGF5KCkgLSA5MCBkYXlzLCBUb2RheSgpXQoKZGVmaW5lICJJcyBSZWNvbW1lbmRhdGlvbiBBcHBsaWNhYmxlPyI6CiAgIkluY2x1c2lvbiBDcml0ZXJpYSIKICAgIGFuZCBub3QgIkV4Y2x1c2lvbiBDcml0ZXJpYSIKCmRlZmluZSAiSW5jbHVzaW9uIENyaXRlcmlhIjoKICAiUGF0aWVudCAxOCBvciBPbGRlcj8iCiAgICBhbmQgIk5vdCBSZWNlaXZpbmcgRXZpZGVuY2UtQmFzZWQgVHJlYXRtZW50IGZvciBPcGlvaWQgVXNlIERpc29yZGVyIgogICAgYW5kICJQcmVzZW5jZSBvZiBEaWFnbm9zaXMgb2YgT3Bpb2lkIFVzZSBEaXNvcmRlciIKICAgIGFuZCAiUG9zaXRpdmUgUmVzdWx0IGZyb20gT3Bpb2lkIFVzZSBEaXNvcmRlciBFdmFsdWF0aW9uIFRvb2wiCgpkZWZpbmUgIkV4Y2x1c2lvbiBDcml0ZXJpYSI6CiAgZmFsc2UKCmRlZmluZSAiUGF0aWVudCAxOCBvciBPbGRlcj8iOgogIENvbmZpZy4iQWdlIExlc3MgdGhhbiAxOCBZZWFycyBJcyBFbmFibGVkIgogICAgYW5kIEFnZUluWWVhcnMoKSA+PSAxOAoKZGVmaW5lICJOb3QgUmVjZWl2aW5nIEV2aWRlbmNlLUJhc2VkIFRyZWF0bWVudCBmb3IgT3Bpb2lkIFVzZSBEaXNvcmRlciI6CiAgQ29uZmlnLiJFdmlkZW5jZSBCYXNlZCBUcmVhdG1lbnQgQ3JpdGVyaWEgRm9yIE9waW9pZCBVc2UgRGlzb3JkZXIiCiAgICBhbmQgbm90ICgKICAgICAgZXhpc3RzICgKICAgICAgICBbTWVkaWNhdGlvblJlcXVlc3Q6IENvbW1vbi4iQnVwcmVub3JwaGluZSBhbmQgbWV0aGFkb25lIG1lZGljYXRpb25zIl0gTVIKICAgICAgICAgIHdoZXJlIE1SLnN0YXR1cyBpbiB7ICdhY3RpdmUnLCAnY29tcGxldGVkJyB9CiAgICAgICAgICAgIGFuZCBkYXRlIGZyb20gTVIuYXV0aG9yZWRPbiBkdXJpbmcgZGF5IG9mICJPcGlvaWQgVXNlIERpc29yZGVyIExvb2tiYWNrIFBlcmlvZCIKICAgICAgKQogICAgICBvciBleGlzdHMgKAogICAgICAgIFtQcm9jZWR1cmU6IENvbW1vbi4iU3Vic3RhbmNlIG1pc3VzZSBiZWhhdmlvcmFsIGNvdW5zZWxpbmciXSBQCiAgICAgICAgICB3aGVyZSBQLnN0YXR1cyB+ICdjb21wbGV0ZWQnCiAgICAgICAgICBhbmQgKAogICAgICAgICAgICBjYXNlCiAgICAgICAgICAgICAgd2hlbiBQLnBlcmZvcm1lZCBpcyBGSElSLmRhdGVUaW1lIHRoZW4KICAgICAgICAgICAgICAgIEludGVydmFsW0ZISVJIZWxwZXJzLlRvRGF0ZVRpbWUoUC5wZXJmb3JtZWQgYXMgRkhJUi5kYXRlVGltZSksIEZISVJIZWxwZXJzLlRvRGF0ZVRpbWUoUC5wZXJmb3JtZWQgYXMgRkhJUi5kYXRlVGltZSldCiAgICAgICAgICAgICAgd2hlbiBQLnBlcmZvcm1lZCBpcyBGSElSLlBlcmlvZCB0aGVuCiAgICAgICAgICAgICAgICBGSElSSGVscGVycy5Ub0ludGVydmFsKFAucGVyZm9ybWVkIGFzIEZISVIuUGVyaW9kKQogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG51bGwgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+CiAgICAgICAgICAgICAgZW5kCiAgICAgICAgICApCiAgICAgICAgICBkdXJpbmcgZGF5IG9mICJPcGlvaWQgVXNlIERpc29yZGVyIExvb2tiYWNrIFBlcmlvZCIKICAgICAgKQogICkKCmRlZmluZSAiUHJlc2VuY2Ugb2YgRGlhZ25vc2lzIG9mIE9waW9pZCBVc2UgRGlzb3JkZXIiOgogIGV4aXN0cyAoIkRpYWdub3NpcyBvZiBPcGlvaWQgVXNlIERpc29yZGVyIikKCmRlZmluZSAiRGlhZ25vc2lzIG9mIE9waW9pZCBVc2UgRGlzb3JkZXIiOgogIENvbW1vbi4iVVMgQ29yZS1DYXRlZ29yaXplZCBDb25kaXRpb25zIiBDCiAgICB3aGVyZSBDLmNvZGUgaW4gQ29tbW9uLiJPcGlvaWQgbWlzdXNlIGRpc29yZGVycyIKICAgICAgYW5kIEMuY2xpbmljYWxTdGF0dXMgaW4gQ29tbW9uLiJBY3RpdmUgQ29uZGl0aW9uIgogICAgICBhbmQgZGF0ZSBmcm9tIEMuYXNzZXJ0ZWREYXRlIGR1cmluZyBkYXkgb2YgIk9waW9pZCBVc2UgRGlzb3JkZXIgTG9va2JhY2sgUGVyaW9kIgoKZGVmaW5lICJQb3NpdGl2ZSBSZXN1bHQgZnJvbSBPcGlvaWQgVXNlIERpc29yZGVyIEV2YWx1YXRpb24gVG9vbCI6CiAgdHJ1ZQoKZGVmaW5lICJHZXQgSW5kaWNhdG9yIjoKICBpZiAiSXMgUmVjb21tZW5kYXRpb24gQXBwbGljYWJsZT8iCiAgICB0aGVuICd3YXJuaW5nJwogIGVsc2UgbnVsbAoKZGVmaW5lICJHZXQgU3VtbWFyeSI6CiAgaWYgIklzIFJlY29tbWVuZGF0aW9uIEFwcGxpY2FibGU/IgogICAgdGhlbiAnUmVjb21tZW5kIG9waW9pZCBhZ29uaXN0IG9yIHBhcnRpYWwgYWdvbmlzdCB0cmVhdG1lbnQgd2l0aCBtZXRoYWRvbmUgbWFpbnRlbmFuY2UgdGhlcmFweSBvciBidXByZW5vcnBoaW5lIGFuZC9vciBiZWhhdmlvcmFsIHRoZXJhcHknCiAgZWxzZSBudWxsCgpkZWZpbmUgIkdldCBEZXRhaWwiOgogIGlmICJJcyBSZWNvbW1lbmRhdGlvbiBBcHBsaWNhYmxlPyIKICAgIHRoZW4gbnVsbAogIGVsc2UgbnVsbAoKICAvLyBEZXRlY3RlZCBJc3N1ZSAtIE9waW9pZCB1c2UgZGlzb3JkZXI7IG9mZmVyIG9yIGFycmFuZ2UgZXZpZGVuY2UtYmFzZWQgdHJlYXRtZW50ICh1c3VhbGx5CiAgLy8gbWVkaWNhdGlvbi1hc3Npc3RlZCB0cmVhdG1lbnQgd2l0aCBidXByZW5vcnBoaW5lIG9yIG1ldGhhZG9uZSBpbiBjb21iaW5hdGlvbgogIC8vIHdpdGggYmVoYXZpb3JhbCB0aGVyYXBpZXMpQXZvaWQgcHJlc2NyaWJpbmcgb3Bpb2lkIHBhaW4gbWVkaWNhdGlvbiBhbmQgYmVuem9kaWF6ZXBpbmVzIGNvbmN1cnJlbnRseQoKICBkZWZpbmUgIk9waW9pZCBVc2UgRGlzb3JkZXIsIEFycmFuZ2UgVHJlYXRtZW50IElzc3VlIjoKICAgIERldGVjdGVkSXNzdWUgewogICAgICAvL2lkZW50aWZpZXI6LAogICAgICBzdGF0dXM6IEZISVIuT2JzZXJ2YXRpb25TdGF0dXMgeyB2YWx1ZTogJ3ByZWxpbWluYXJ5JyB9LAogICAgICBjYXRlZ29yeTogRkhJUi5Db2RlYWJsZUNvbmNlcHQgeyB0ZXh0OiBGSElSLnN0cmluZyB7IHZhbHVlOiAiR2V0IFN1bW1hcnkiIH0gfSwKICAgICAgc2V2ZXJpdHk6IEZISVIuRGV0ZWN0ZWRJc3N1ZVNldmVyaXR5IHsgdmFsdWU6ICdtb2RlcmF0ZScgfSwKICAgICAgcGF0aWVudDogRkhJUi5SZWZlcmVuY2UgeyByZWZlcmVuY2U6IEZISVIuc3RyaW5nIHsgdmFsdWU6ICdQYXRpZW50LycgKyBQYXRpZW50LmlkIH0gfSwKICAgICAgZGF0ZTogRkhJUi5kYXRlVGltZSB7IHZhbHVlOiBOb3coKSB9LAogICAgICAvLyBUT0RPOiBEZXZpY2UgcmVwcmVzZW50YXRpb24uLi4KICAgICAgLy8gYXV0aG9yOiwKICAgICAgaW1wbGljYXRlZDoKICAgICAgICAoIkRpYWdub3NpcyBvZiBPcGlvaWQgVXNlIERpc29yZGVyIikgQwogICAgICAgICAgcmV0dXJuIEZISVIuUmVmZXJlbmNlIHsgcmVmZXJlbmNlOiBGSElSLnN0cmluZyB7IHZhbHVlOiAnQ29uZGl0aW9uLycgKyBDLmlkIH0gfSwKICAgICAgZGV0YWlsOiBGSElSLnN0cmluZyB7IHZhbHVlOiAiR2V0IERldGFpbCIgfSwKICAgICAgcmVmZXJlbmNlOiBGSElSLnVyaSB7IHZhbHVlOiAnaHR0cDovL2ZoaXIub3JnL2d1aWRlcy9jZGMvb3Bpb2lkLWNkcy9QbGFuRGVmaW5pdGlvbi9vcGlvaWRjZHMtMTItcGF0aWVudC12aWV3J30KICAgIH0K"
  } ]
}